
function getQuestions() {
    axios.get('http://localhost:3000/api/getAll').then(response => {

        var divContent = ' ';
        console.log(response.data);

        var post = response.data;
        console.log(post["results"].length);
        for (let i = 0; i < post["results"].length; i++) {

            console.log(post["results"][i].qid + " " + "value " + i);
            divContent += "<div class='question' onclick='my(" + post['results'][i].qid + ")' <p> " + post["results"][i].title + "</p></div>";


        }

        document.getElementById("allPost").innerHTML = divContent;


    })
        .catch(error => console.error(error));
}
function my(questionID) {
    //alert("hi " + questionID);
    axios.post('http://localhost:3000/api/set', { questionID: questionID }).then(response => {

        window.location.href = "dynamicPost.html";
    })
        .catch(error => console.error(error));
}

function loadPost() {
    axios.get('http://localhost:3000/api/loadPost').then(response => {

        let Post = response.data;
        console.log("incoming post " + Post["Question"][0]["qid"]);
        console.log("result length " + Post["answers"].length);
        //console.log("answers " + Post["answers"][0]["answers"]);

        //console.log(Post["reply_data"][1][0]["reply"]);

        var header = document.getElementById('Question');
        //var usernameDetail = document.getElementById('usernameDetail');
        var innerHTML_Post = document.getElementById('Answers');
        header.innerHTML = Post["Question"][0]["question"];
        // usernameDetail.innerHTML = Post["Question"][0]["username"];
        var content = `<h1>ALL ANSWERS</h1>
           `;
        for (var j = 0; j < Post["answers"].length; j++) {
            content += `
            
         <div id="Answer_box">
                 <span id="username">
                     <p> USERNAME : ${Post["answers"][j]["username"]}</p >
                 </span >
                 <h3>
                 ${Post["answers"][j]["answers"]}
                 </h3>
                
                  `;

            for (let i = 0; i < Post["reply_data"][j].length; i++) {
                content += `
                      <div id="reply_box">
                     <span id="username">
                        username: <p> ${Post["reply_data"][j][i]["username"]}
                         </p >
                     </span >

                <h4>
                    ${Post["reply_data"][j][i]["reply"]}
                </h4>
 
 
                 </div >

                `;
            }




            content += `
            <div class="reply_area" >
            <center><h5>Leave Your Reply</h5>
            <label for"username">Username </label> : <input type="text" id="${Post["answers"][j]["aid"]}"><br><br>
            <label for"reply">ur Reply </label> :<input type="text" id="${(Post["answers"][j]["aid"]) + 11}"><br><br>    
            <button onclick="reply(${Post["answers"][j]["aid"]})"> Post </button></center>
            </div>
            </div >`
        }
        content += `<span id="answer_area">
            <h2>Post Your Answer</h2>
            <label for"username">Username </label> : <input type="text" id="answer_username"><br><br>
            <label for="answer"> Answer<label> : <textarea name="answer" id="answer" cols="60" rows="10"></textarea>
        <br><br><center><button id="post_button" onclick="answer(${Post["Question"][0]["qid"]})"> Post Your Answer</button> <center>
    </span>`;
        innerHTML_Post.innerHTML = content;


    })
        .catch(error => console.error(error));

}
function reply(aid) {


    console.log("aid =", aid);
    let reply_username = document.getElementById(aid).value;
    let question_reply = document.getElementById(aid + 11).value;

    console.log(reply_username, question_reply);
    axios.post('http://localhost:3000/api/reply', { aid: aid, reply_username: reply_username, question_reply: question_reply }).then(response => {



        //alert("ddan");
        window.location = 'http://127.0.0.1:5500/dynamicPost.html';



    })
        .catch(error => console.error(error));



}
function answer(qid) {


    console.log("qid =", qid);
    let answer_username = document.getElementById("answer_username").value;
    let answer = document.getElementById("answer").value;

    //onsole.log(reply_username, question_reply);
    axios.post('http://localhost:3000/api/answer', { qid: qid, answer_username: answer_username, answer: answer }).then(response => {



        //alert("ddan");
        window.location = 'http://127.0.0.1:5500/dynamicPost.html';



    })
        .catch(error => console.error(error));



}
